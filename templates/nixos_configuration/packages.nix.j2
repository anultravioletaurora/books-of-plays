{ config, pkgs, ... }:

{
  # packages.nix
  # Contains configuration for all deployed Nixpkgs
  {# Default system packages #}
  environment.systemPackages = (with pkgs; [
    curl
    fastfetch
    fish
    git
    nano
    python3Full # Needed for ansible to work
    rclone
    tmux
    wget

  {% if install_desktop_packages %}
  ]) ++ (with pkgs; [
    appimage-run
    ardour
    discord
    dracula-theme
    fantasque-sans-mono
    {{ "gearlever" if system.unstable }}
    {{ system.unstable | ternary("gnome-tweaks", "gnome.gnome-tweaks") }}
    google-chrome
    krita
    mission-center
    nextcloud-client
    plexamp
    popsicle
    qFlipper
    rnote
    spotify
    transmission
    warp-terminal
  {% endif %}

  {% if install_gaming_packages %}
  ]) ++ (with pkgs; [
    {{ gaming_pkg_list }}
  {% endif %}

  {% if install_media_packages %}
  ]) ++ (with pkgs; [
    freetube
  {% endif %}

  {% if install_htpc_packages %}
  ]) ++ (with pkgs; [
    {{ htpc_pkgs | select | list | join("\n") }}
  {% endif %}

  {% if install_devtool_packages %}
  ]) ++ (with pkgs; [
    nodejs_22
    (vscode-with-extensions.override {
      vscodeExtensions = with vscode-extensions; [
        bbenoist.nix
        hashicorp.hcl
        ms-python.python
        prisma.prisma
        redhat.ansible
        redhat.java
        redhat.vscode-yaml
        svelte.svelte-vscode
        dracula-theme.theme-dracula
      ];
    })
    {{ "zed-editor" if system.unstable }}
  {% endif %}
  ]);
}
